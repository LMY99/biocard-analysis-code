frame
} %>% mutate(Biomarker=factor(biomarker, levels=names))
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names))
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=biomarker)) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=biomarker),alpha=0.1) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
ylab("Abnormality")
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker)) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
ylab("Abnormality")
# Make CI plot for Unit-Scaled Biomarker Trajectory
agex <- seq(from=min(boundary.knot),to=max(boundary.knot),by=0.01)
basis <- ibs(agex, knots=knot.list[[1]], Boundary.knots = boundary.knot,
degree=2, intercept=TRUE)[,3:22]
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names))
colors0 <- c("darkred","red","orange","yellow","green","darkgreen","lightblue",
"blue","darkblue","purple","black")
names(colors0) <- names
p1 <-
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker)) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
ylab("Abnormality")
pdf()
print(p1)
dev.off()
pdf(width=14)
print(p1);dev.off()
agex <- seq(from=min(boundary.knot),to=max(boundary.knot),by=0.1)
basis <- ibs(agex, knots=knot.list[[1]], Boundary.knots = boundary.knot,
degree=2, intercept=TRUE)[,3:22]
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names))
colors0 <- c("darkred","red","orange","yellow","green","darkgreen","lightblue",
"blue","darkblue","purple","black")
names(colors0) <- names
p1 <-
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker)) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
ylab("Abnormality")
pdf(width=14); print(p1);dev.off()
pdf(width=14); print(p1);dev.off()
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/main_S_realdata.R")
gc()
doParallel::stopImplicitCluster()
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/main_S_realdata.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
# Make plots for manuscript
library(tidyverse)
library(splines2)
library(foreach)
rm(list=ls()); gc(verbose=FALSE)
load("biocard_result_group16nonzeros.RData")
# Make Point-CI plot for covariate effect ----
indice <- (R/2+1):R
summary_fixed <- apply(coefs[2:4,,indice],c(1,2),
function(x) c(mean=mean(x),quantile(x,c(.025,.975))))
dimnames(summary_fixed)[[2]] <- c("APOE4 vs Non-APOE4","Female vs Male","Education")
dimnames(summary_fixed)[[1]] <- c("mean","lower","upper")
#dimnames(summary_fixed)[[3]] <- colnames(Y)
sf <- t(Reduce(cbind, list(
summary_fixed[,,1],
summary_fixed[,,2],
summary_fixed[,,3],
summary_fixed[,,4],
summary_fixed[,,5],
summary_fixed[,,6],
summary_fixed[,,7],
summary_fixed[,,8],
summary_fixed[,,9],
summary_fixed[,,10],
summary_fixed[,,11]
)))
library(ggplot2)
names <- c("MMSE","LogMem","DSST","ENT.THICK","HIPPO","ENT.VOL",
"MTL","SPARE_AD","t_tau","p_tau181","AB42_AB40_Ratio")
sf <- data.frame(sf, variable=rownames(sf), biomarker=rep(names,each=3),
x=rep(c(-0.1,0,0.1),11)+rep(1:11,each=3),
row.names = NULL)
sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper))
sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
pivot_wider(names_from = biomarker, values_from = text)
sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text) %>%
pivot_wider(names_from = biomarker, values_from = text)
sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text)
View(sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text)
)
View(sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text) %>%
t()
)
View(sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text) %>%
t()
)
install.packages('janitor')
View(sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text) %>%
t() %>%
janitor::row_to_names(1)
)
sf %>% mutate(text=sprintf("% .2f(% .2f,% .2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text) %>%
t() %>%
janitor::row_to_names(1) %>%
xtable::xtable()
sink()
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
# Make plots for manuscript
library(tidyverse)
library(splines2)
library(foreach)
rm(list=ls()); gc(verbose=FALSE)
load("biocard_result_group16nonzeros.RData")
# Make Point-CI plot for covariate effect ----
indice <- (R/2+1):R
summary_fixed <- apply(coefs[2:4,,indice],c(1,2),
function(x) c(mean=mean(x),HDInterval::hdi(x)))
dimnames(summary_fixed)[[2]] <- c("APOE4 vs Non-APOE4","Female vs Male","Education")
dimnames(summary_fixed)[[1]] <- c("mean","lower","upper")
#dimnames(summary_fixed)[[3]] <- colnames(Y)
sf <- t(Reduce(cbind, list(
summary_fixed[,,1],
summary_fixed[,,2],
summary_fixed[,,3],
summary_fixed[,,4],
summary_fixed[,,5],
summary_fixed[,,6],
summary_fixed[,,7],
summary_fixed[,,8],
summary_fixed[,,9],
summary_fixed[,,10],
summary_fixed[,,11]
)))
library(ggplot2)
names <- c("MMSE","LogMem","DSST","ENT.THICK","HIPPO","ENT.VOL",
"MTL","SPARE_AD","t_tau","p_tau181","AB42_AB40_Ratio")
sf <- data.frame(sf, variable=rownames(sf), biomarker=rep(names,each=3),
x=rep(c(-0.1,0,0.1),11)+rep(1:11,each=3),
row.names = NULL)
sf %>% mutate(text=sprintf("% 5.2f(% 5.2f,% 5.2f)",mean,lower,upper)) %>%
select(biomarker, text, variable) %>%
pivot_wider(names_from = biomarker, values_from = text) %>%
t() %>%
janitor::row_to_names(1) %>%
xtable::xtable() %>%
print()
# Make plots for manuscript
library(tidyverse)
library(splines2)
library(foreach)
rm(list=ls()); gc(verbose=FALSE)
load("biocard_result_group16nonzeros.RData")
# Make Point-CI plot for covariate effect ----
indice <- (R/2+1):R
summary_fixed <- apply(coefs[2:4,,indice],c(1,2),
function(x) c(mean=mean(x),HDInterval::hdi(x)))
dimnames(summary_fixed)[[2]] <- c("APOE4 vs Non-APOE4","Female vs Male","Education")
dimnames(summary_fixed)[[1]] <- c("mean","lower","upper")
#dimnames(summary_fixed)[[3]] <- colnames(Y)
sf <- t(Reduce(cbind, list(
summary_fixed[,,1],
summary_fixed[,,2],
summary_fixed[,,3],
summary_fixed[,,4],
summary_fixed[,,5],
summary_fixed[,,6],
summary_fixed[,,7],
summary_fixed[,,8],
summary_fixed[,,9],
summary_fixed[,,10],
summary_fixed[,,11]
)))
library(ggplot2)
names <- c("MMSE","LogMem","DSST","ENT.THICK","HIPPO","ENT.VOL",
"MTL","SPARE_AD","t_tau","p_tau181","AB42_AB40_Ratio")
sf <- data.frame(sf, variable=rownames(sf), biomarker=rep(names,each=3),
x=rep(c(-0.1,0,0.1),11)+rep(1:11,each=3),
row.names = NULL)
# Make Goodness-of-fit Plot for select variables
fitted_values <- array(0, dim(Y))
colnames(fitted_values) <- names
colnames(Y) <- names
for(i in 1:K){
fit <- covar.list[[i]] %*% coefs[,i,indice] + REs[df$ID,i,indice]
fitted_values[,i] <- apply(fit,1,mean)
fitted_values[is.na(Y[,i]),i] <- NA
}
fitted_values <- as.data.frame(fitted_values)
Y$type <- "Data"
Y$id <- df$ID
Y$age <- df$ageori
fitted_values$type <- "Fitted"
fitted_values$id <- df$ID
fitted_values$age <- df$ageori
select_biom <- c(-1,-2,-4,-5,-7,-8,-10,-11)
gof_data <- rbind(Y, fitted_values)[,select_biom]
agex <- seq(from=min(boundary.knot),to=max(boundary.knot),by=0.1)
basis <- ibs(agex, knots=knot.list[[1]], Boundary.knots = boundary.knot,
degree=2, intercept=TRUE)
basis <- basis[,3:(ncol(basis)-2)]
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names))
colors0 <- c("darkred","red","orange","yellow","green","darkgreen","lightblue",
"blue","darkblue","purple","black")
names(colors0) <- names
p1 <-
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker)) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
scale_y_continuous(limits=c(0,1)) +
ylab("Abnormality") + theme(legend.justification = c(0,0.5),
axis.text.y = element_text())
pdf(width=14); print(p1);dev.off()
View(spline_std)
as.data.frame(1)
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 2, function(x) ages[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame(age=.) %>% mutate(Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
as.data.frame(2)
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 2, function(x) ages[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=.)
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1) %>%
mutate(value=approx(agex, curve_mean, age))
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
?approx
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
approx(agex, curve_mean, frame$age)
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
spline_std <- rbind(spline_std,
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
)
spline_std
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Curve')
spline_std <- rbind(spline_std,
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark')
)
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Curve')
spline_std <- rbind(spline_std,
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark'),
fill=TRUE
)
spline_std
spline_std <- rbind(spline_std,
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame$lower <- NA; frame$upper <- NA
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark'),
fill=TRUE
)
spline_std
View(spline_std)
spline_std <-
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
frame <- apply(curves, 1, function(x) c(value=mean(x), HDInterval::hdi(x))) %>% t() %>%
as.data.frame() %>% mutate(age=agex, Biomarker=names[i])
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Curve')
spline_std <- rbind(spline_std,
foreach(i=1:K,.combine=rbind) %do% {
curves <- basis %*% coefs[-(1:4),i,indice]
curves <- apply(curves, 2, function(x) x/max(x))
curve_mean <- apply(curves, 1, mean)
frame <- apply(curves, 2, function(x) agex[max(which(diff(x,differences=2)>=0))+1]) %>%
mean() %>%
as.data.frame() %>% mutate(Biomarker=names[i]) %>% rename(age=1)
frame$value <- approx(agex, curve_mean, frame$age)$y
frame$lower <- NA; frame$upper <- NA
frame
} %>% mutate(Biomarker=factor(Biomarker, levels=names), type='Mark'),
fill=TRUE
) %>% filter(!is.na(Biomarker))
p1 <-
spline_std %>% ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker), data=subset(., type=='Curve')) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1,
data=subset(., type=='Curve')) +
geom_point(aes(x=age,y=value,color=Biomarker),data=subset(., type=='Mark'),shape=4) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
scale_y_continuous(limits=c(0,1)) +
ylab("Abnormality") + theme(legend.justification = c(0,0.5),
axis.text.y = element_text())
p1 <-
ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker), data=subset(spline_std, type=='Curve')) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1,
data=subset(spline_std, type=='Curve')) +
geom_point(aes(x=age,y=value,color=Biomarker),data=subset(spline_std, type=='Mark'),shape=4) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
scale_y_continuous(limits=c(0,1)) +
ylab("Abnormality") + theme(legend.justification = c(0,0.5),
axis.text.y = element_text())
pdf(width=14); print(p1);dev.off()
p1 <-
ggplot() +
geom_line(aes(x=age,y=value,group=Biomarker,color=Biomarker), data=subset(spline_std, type=='Curve')) +
geom_ribbon(aes(x=age,ymin=lower,ymax=upper,group=Biomarker,fill=Biomarker),alpha=0.1,
data=subset(spline_std, type=='Curve')) +
geom_point(aes(x=age,y=value,color=Biomarker),data=subset(spline_std, type=='Mark'),shape=19) +
scale_color_manual(values=colors0) +
scale_fill_manual(values=colors0) +
scale_x_continuous(limits=c(50,100)) +
scale_y_continuous(limits=c(0,1)) +
ylab("Abnormality") + theme(legend.justification = c(0,0.5),
axis.text.y = element_text())
pdf(width=14); print(p1);dev.off()
pdf(width=14); print(p1);dev.off()
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
gc()
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
gc()
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
spline_std
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
View(spline_std)
order(spline_std %>% filter(type=='Mark') %>% select(age))
order(spline_std %>% filter(type=='Mark') %>% select(age) %>% as.vector())
spline_std %>% filter(type=='Mark') %>% select(age)
as.vector(spline_std %>% filter(type=='Mark') %>% select(age))
as.numeric(spline_std %>% filter(type=='Mark') %>% select(age))
class(spline_std %>% filter(type=='Mark') %>% select(age))
?select
(spline_std %>% filter(type=='Mark') %>% extract('age'))
?extract
spline_std %>% filter(type=='Mark') %>% select(age) %>% as.matrix() %>% as.vector()
spline_std %>% filter(type=='Mark') %>% select(age) %>% as.matrix() %>% as.vector() %>% order(decreasing = FALSE)
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
factor
?factor
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
source("C:/Users/alfie/OneDrive/Desktop/PlainMono/realdata/manuscript_plot.R")
